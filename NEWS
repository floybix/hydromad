
Changes in Version 0.9-0 (in development)

  o NOTE: major changes that will break existing code (see below).

  o new function buildObjectiveFunction().

  o objective functions can now include expressions which will be evaluated
    once and cached for efficiency by calibration/simulation functions.
    See ?hydromad.stats

  o fitStat() now returns, typically, sum((Q-X)^2)/sum((Q-ref)^2)
    whereas it used to return 1 - this. So "R squared" is now
    calculated as ~ 1 - fitStat(Q,X).

  o tsFitStat() has been removed as fitStat() now automatically merges
    time series and its other functionality has been taken over by
    buildObjectiveFunction().

  o fitBias() has been removed in favour of hmadstat("rel.bias").

  o the 'offset' argument to fitStat() has been removed; in particular log
    transformations will not have an automatic offset added unless you use
    hmadstat("r.sq.log").

  o hydromad.options("stats") has been removed in favour of hydromad.stats().

  o eventseq() now takes extra arguments 'inthresh', 'inx', 'extend' and 
    'continue'. The 'inter' argument, which was deprecated, has been removed.

  o new function eventsExplorer(), a graphical user interface.

Changes in Version 0.8-7

  o the default log-likelihood function (hydromad.options("loglik")) changed.

  o optimtrace() for Dream results now avoids a problem with objective values.
    (not an issue with runs generated from dream >= 0.3-2).

  o summary.runlist() now passes on further arguments to summary() (or FUN).

  o the summary() method for hydromad.runlist now has with.hydrostats = FALSE.

Changes in Version 0.8-6

  o new function optimtrace() to extract history of fitting process.

  o the 'elitism' option to SCEoptim() now defaults to 1 (linear weights).

  o fitByOptim() now handles boundaries differently, perhaps avoiding errors.

Changes in Version 0.8-5

  o statistics are now managed by new functions hydromad.stats()
    and hmadstat(). The use of hydromad.options("stats") is now
    deprecated.

  o statistics and objective functions are now represented as
    functions rather than formulae. Formulae can still be
    specified for the 'objective' argument, for convenience.

  o changed tsFitStat() to calculate 'ref' as mean(trans(obs)) 
    rather than trans(mean(obs)), as was always intended.
    Also fitStat() now removes any NAs introduced by 'trans'.

  o the coef()<- assignment method has been removed.

  o new update() method for runlists, which simple uses lapply().

Changes in Version 0.8-4

  o revised statistics.

  o new method "PORT", based on nlminb(), for fitByOptim().

  o changes some default options for SCEoptim() and fitBy*().

Changes in Version 0.8-3

  o new power and hyperbolic forms of the CMD model,
    contributed by Jarkko Koskela.

  o added hydromad.options("loglik"), used by fitByDream() and 
    a new logLik() method.

  o new function fitByOptim1(), for optimising a single parameter.

  o new function fitDbmToPeaks() for use with sma = "dbm".

  o fixed error when using rfit methods with "expuh" routing.

  o fixed error when using coef() on a runlist.

Changes in Version 0.8-2

  o new function fitByDream(), using the dream package.
    NB: this uses a likelihood function, not the objective function.

  o the fitting functions now store the result from their 
    respective optimisation functions in the model object as "fit.result",
    and fitByOptim and fitBySampling now record the objective over time.

  o fitByOptim, fitBySCE, fitByDE all now have a vcov argument, 
    default FALSE, to estimate the parameter variance-covariance matrix.

  o xyplot() applied to a hydromad.runlist now recognises the 'scales' 
    argument (it was erroneously ignored previously).

Changes in Version 0.8-1

  o fixed the "r.sq.monthly" statistic (it gave an error).

  o added new statistics "r.sq.smooth7", "ar1" and "X0", and
    fixed "X1" and "U1" (they threw an error).

  o summary() now gives a warning for NaN stats, not an error.

  o new function findThresh() and correponding argument 'n' to
    eventseq(), to identify a given number of events.

  o arguments to eventseq() and eventapply() have changed.

  o estimateDelay() now has a 'negative.ok' argument.

  o the setting 'series = 1' to expuh.sim() now places the "s"
    component in parallel, rather than the "q" component.

  o 'HydroTestData' now has a (POSIXct) 3 hourly time index.

Changes in Version 0.8-0

  o the "bucket" SMA now has a C code back-end.

Changes in Version 0.7-3

  o the update() method now has a 'newpars' argument, to supply parameter
    values as a named vector rather than a series of named arguments.

  o the summary() method now takes a 'stats' argument, and definitions of 
    these are looked up in hydromad.options("stats"). The default set of
    stats is given (as a set of names) in hydromad.options("summary.stats").

  o improved the "tutorial" vignette.

  o improved examples for SMA models.

Changes in Version 0.7-2

  o time series data is now stored as 'zooreg' rather than 'ts',
    and fitted(), residuals(), predict() will generally return 'zooreg'.
    The simulation functions will keep to the format of their input data.

  o xyplot() methods for 'hydromad' and 'runlist' have been rewritten.

  o the package now depends on the new version of lattice, and therefore
    depends on R version 2.11.0 or later.

Changes in Version 0.7-1

  o column names are retained in eventapply, it now has a 'simplify'
    argument, and it just generally works better.

  o 'summary' with the 'breaks' argument now returns a zoo object
    rather than a data.frame, which makes plotting easier.

  o fixed bug in print.summary.runlist

Changes in Version 0.7-0

  o the mass balance term 'c' in cwi.sim is now called 'scale'.

  o arbitrary arguments for the model simulation function(s) 
    (i.e. objects which are not to be treated as model parameters) 
    may now be passed to 'hydromad'.

  o new power law routing 'powuh'.

  o new SMA 'awbm'.

  o the 'summary' method for 'runlist' is now much simpler and does not
    include parameter values (as the 'pars' argument did previously).
    Instead a 'coef' method for 'runlist' returns the parameter values.

  o 'summaryOrders' removed, just use 'summary'.

  o fixed another case of hydromad() failing if 'Q' was not given in DATA.

  o renamed 'eventAttributes' to 'eventinfo'.

  o 'width' parameter for 'runoffratio' SMA now defaults to 30.

  o more complete help pages and examples.

Changes in Version 0.6-6

  o the CMD and snow models now run C code when return_state = TRUE.

  o fixed a bug in simulate() and fitBySampling() for models with only
    one (or zero) free parameters.

  o coef<-() method now has an 'all' argument, allowing free parameters
    to be easily updated inside an optimisation / simulation loop.

Changes in Version 0.6-5

  o fixed the case where hydromad() failed if 'Q' was not given in DATA.

Changes in Version 0.6-4

  o snow.sim now has a C code back-end.

  o parameterSets (used by fitBySampling etc) now generates a regular
    sequence along each parameter range, rather than using quantile().

Changes in Version 0.6-3

  o new SMA "snow" -- as function snow.sim() -- from Jarkko Koskela.

  o SMA "runoffratio" now has threshold and mass balance parameters.

  o class of hydromad objects is now c("hydromad.<sma>", "hydromad").

  o the 'fixed.ar' argument to armax.sriv.fit now works
    (and this is used by expuh rfit methods too).

  o hydromad.options("prefilter") now has 3 hard-coded prefilters.
    The 'prefilter' argument is now allowed to be a prefilter-generating
    function (function(DATA)).

  o more information about fit results is printed.

Changes in Version 0.6-2

  o armax.sriv.fit() now takes an argument fallback (default TRUE),
    to return the current best result if the matrix cannot be solved.

  o predict(return_components = TRUE) didn't work.

Changes in Version 0.6-1

  o armax.sim() (and therefore predict()) takes return_components argument.

  o new simple SMA "runoffratio" - and function runoffratio.sim().
    (it scales P by observed flow, so can not be used for prediction).

  o coef() can now be assigned to.

  o update(model, sma = ...) changes the SMA and resets its parameters.

  o changed default hydromad.options("inverse.rel.tolerance") to 1/1000.

Changes in Version 0.6-0

  o "uh" routing renamed to "armax".

  o new "lambda" routing option.

  o better simulation of third order transfer function models.

  o unit tests for transfer functions.

Changes in Version 0.5-4

  o event.clusters() renamed to eventseq()

  o functions getU() and getP() removed;
    use fitted(U = TRUE) and observed(item = "P").
